---
title: "Seasonal Difference Exploration"
author: "Hao Zheng (hz2770)"
date: "5/6/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(kableExtra)
```

## Explore the seasonal differences
```{r}
load("./dt_long.RData")
load("./ID_in.RData")
load("./beta.res.postmean.RData")

dt_season <-
  dt_long %>%
  drop_na() %>% 
  filter(ID %in% ID_in) %>% 
  distinct(ID, .keep_all = TRUE) %>% 
  select(ID, Season, Month, Nature) %>% 
  mutate(Month = factor(Month, levels = month.name))
```

```{r}
season_diff <- 
  merge(dt_season, beta.res.postmean, by = c("ID")) %>%
  janitor::clean_names()

# Beta0
intercept.fit <- lm(intercept ~ month + season + nature, data = season_diff)
# Beta1
wind_prev.fit <- lm(wind_prev ~ month + season + nature, data = season_diff)
# Beta2
lat_change.fit <- lm(lat_change ~ month + season + nature, data = season_diff)
# Beta3
long_change.fit <- lm(long_change ~ month + season + nature, data = season_diff)
#Beta4
wind_change.fit <- lm(wind_change ~ month + season + nature, data = season_diff)

summary(intercept.fit)
summary(wind_prev.fit)
summary(lat_change.fit)
summary(long_change.fit)
summary(wind_change.fit)
```

```{r, results = "asis"}
sum0 <- summary(intercept.fit)$coefficients[,c(1,4)]
sum1 <- summary(wind_prev.fit)$coefficients[,c(1,4)]
sum2 <- summary(lat_change.fit)$coefficients[,c(1,4)]
sum3 <- summary(long_change.fit)$coefficients[,c(1,4)]
sum4 <- summary(wind_change.fit)$coefficients[,c(1,4)]

kable(cbind(sum0, sum1, sum2, sum3, sum4)) %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed")) %>% 
  add_header_above(c(" " = 1, "Beta 0" = 2, "Beta 1" = 2, "Beta 2" = 2, "Beta 3" = 2, "Beta 4" = 2))
```

Now based on the estimated Bayesion model from previous questions, we need to explore the seasonal difference. We can fit the 5 estimated beta values against the three predictors: $X_{i,1}$: the month of the year the ith hurricane started, $X_{i,2}$:the year of the ith hurricane and $X_{i,3}$: the nature of the ith hurricane. The beta values obtained from previous Gibbs Sampler MCMC method contains the mean value of $\beta_{0,i}$, $\beta_{1,i}$, $\beta_{2,i}$, $\beta_{3,i}$ and $\beta_{4,i}$ for each of the 697 unique hurricanes.

According to the summary, the R squared value for all the five fitted linear models are quite small, which may indicate bad fit. In addition, most coefficients for the model are not significant. However, for those significant coefficients, we could infer a potential relationship between the certain predictors and the beta values. For the intercept $\beta_{0,i}$,only the intercept for the fitted model is significant. As for $\beta_{1,i}$, the value for the wind speed at time t, the intercept and the season predictor are both quite significant. Therefore, as year increase, the coefficient for $Y_{i,t}$ may decrease a little. For $\beta_{2,i}$, $\beta_{3,i}$ and $\beta_{4,i}$ indicating the latitude, longitude and wind speed change, none of the fitted coefficients are quite significant. 

In conclusion, for different months, there is no significant differences observed. But for different year, the effect the current wind speed has on the next wind speed may decrease for a small amount.

```{r}
# Try to fit the beta model only with the variable season(which indicates the year)
# Beta0
intercept.fit.new <- lm(intercept ~ season, data = season_diff)
# Beta1
wind_prev.fit.new <- lm(wind_prev ~ season, data = season_diff)
# Beta2
lat_change.fit.new <- lm(lat_change ~ season, data = season_diff)
# Beta3
long_change.fit.new <- lm(long_change ~ season, data = season_diff)
#Beta4
wind_change.fit.new <- lm(wind_change ~ season, data = season_diff)

summary(intercept.fit.new)
summary(wind_prev.fit.new)
summary(lat_change.fit.new)
summary(long_change.fit.new)
summary(wind_change.fit.new)

sum0.new <- summary(intercept.fit.new)$coefficients[,c(1,4)]
#colnames(sum0.new) <- c("Estimate0", "p.value0")
sum1.new <- summary(wind_prev.fit.new)$coefficients[,c(1,4)]
#colnames(sum1.new) <- c("Estimate1", "p.value1")
sum2.new <- summary(lat_change.fit.new)$coefficients[,c(1,4)]
#colnames(sum2.new) <- c("Estimate2", "p.value2")
sum3.new <- summary(long_change.fit.new)$coefficients[,c(1,4)]
#colnames(sum3.new) <- c("Estimate3", "p.value3")
sum4.new <- summary(wind_change.fit.new)$coefficients[,c(1,4)]
#colnames(sum4.new) <- c("Estimate4", "p.value4")

kable(cbind(sum0.new, sum1.new, sum2.new, sum3.new, sum4.new)) %>% 
  kable_styling(bootstrap_options = c("striped", "hover", "condensed")) %>% 
  add_header_above(c(" " = 1, "Beta 0" = 2, "Beta 1" = 2, "Beta 2" = 2, "Beta 3" = 2, "Beta 4" = 2))

```

Now we also fit linear models for the season variables (corresponding to the year) to seek for potential evidence of the statement :"the wind speed has been increasing over years". In order to analyze this question, need to inspect on the second model, which corresponds to the wind speed and the year. As we can see from the table, the coefficient for year is quit significant with a negative estimates quite close to zero. Therefore, we can infer that as the year increase, the wind speed may decrease a little, which is contrary to the statement. However, it's quite match with the results shown in the figures in the initial EDA session, which indicates the mean wind speed tends to decrease over years. 
