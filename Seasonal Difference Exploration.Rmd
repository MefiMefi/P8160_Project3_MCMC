---
title: "Seasonal Difference Exploration"
author: "Hao Zheng (hz2770)"
date: "5/6/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```


## Explore the seasonal differences
```{r}
load("./dt_long.RData")
load("./ID_in.RData") 

dt_wind =
  dt_long %>% 
    mutate(intercept = 1) %>% 
    drop_na()
# 700 after drop_na
IDs <- unique(dt_wind$ID)

# 697 observations >=5


dt_mtx_full = dt_wind %>% filter(ID %in% ID_in)

dt_season <- dt_mtx_full[!duplicated(dt_mtx_full$ID),] %>% 
  select(ID, Season, Month, Nature) %>% 
  mutate(Month = factor(Month, levels = month.name))


```

```{r, eval=FALSE}
# use posterior mean of beta as our final Bayesian model coefficients
beta.res.post = matrix(rep(0,694*5), 694, 5)
for (i in 5001:10000) {
    B.res = beta.res.postmean$B[[i]]
    B.res = as.data.frame(B.res)
    beta.res.post = beta.res.post + B.res
}

beta.res.postmean = beta.res.post/5000

season_diff <- cbind(dt_season, beta.res.postmean) %>% janitor::clean_names()

# Beta0
intercept.fit <- lm(intercept ~ month + season + nature, data = season_diff)
# Beta1
wind_prev.fit <- lm(wind_prev ~ month + season + nature, data = season_diff)
# Beta2
lat_change.fit <- lm(lat_change ~ month + season + nature, data = season_diff)
# Beta3
long_change.fit <- lm(long_change ~ month + season + nature, data = season_diff)
#Beta4
wind_change.fit <- lm(wind_change ~ month + season + nature, data = season_diff)

summary(intercept.fit)
summary(wind_prev.fit)
summary(lat_change.fit)
summary(long_change.fit)
summary(wind_change.fit)
```


