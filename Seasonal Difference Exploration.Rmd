---
title: "Seasonal Difference Exploration"
author: "Hao Zheng (hz2770)"
date: "5/6/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
```

## Explore the seasonal differences
```{r}
load("./dt_long.RData")
load("./ID_in.RData")
load("./beta.res.postmean.RData")

dt_season <-
  dt_long %>%
  drop_na() %>% 
  filter(ID %in% ID_in) %>% 
  distinct(ID, .keep_all = TRUE) %>% 
  select(ID, Season, Month, Nature) %>% 
  mutate(Month = factor(Month, levels = month.name))
```

```{r}
season_diff <- 
  merge(dt_season, beta.res.postmean, by = c("ID")) %>%
  janitor::clean_names()

# Beta0
intercept.fit <- lm(intercept ~ month + season + nature, data = season_diff)
# Beta1
wind_prev.fit <- lm(wind_prev ~ month + season + nature, data = season_diff)
# Beta2
lat_change.fit <- lm(lat_change ~ month + season + nature, data = season_diff)
# Beta3
long_change.fit <- lm(long_change ~ month + season + nature, data = season_diff)
#Beta4
wind_change.fit <- lm(wind_change ~ month + season + nature, data = season_diff)

summary(intercept.fit)
summary(wind_prev.fit)
summary(lat_change.fit)
summary(long_change.fit)
summary(wind_change.fit)
```


