---
title: "EDA"
author: "Renjie Wei"
date: '2022-05-03'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(ggplot2)
dt= read.csv("./hurrican703.csv")
ggplot(data=dt, aes(x = Longitude, y = Latitude)) + 
  stat_summary_2d(data = dt, aes(x = Longitude, y = Latitude, z = dt$Wind.kt), fun = median, binwidth = c(1, 1), show.legend = TRUE)
library(data.table)
dt <- as.data.table(dt)
summary(dt)
```

```{r}
library(tidyverse)
dt_long <- dt %>%
  dplyr::group_by(ID) %>% 
  mutate(Lat_change = Latitude - lag(Latitude),
         Long_change = Longitude - lag(Longitude),
         Wind_change = Wind.kt - lag(Wind.kt))
```

```{r}
# Season and count
storms_season_name = distinct(group_by(select(dt_long, Season, ID), Season))
ggplot(data = storms_season_name) + 
  geom_bar(aes(x = Season))

storms_season_name %>% 
  dplyr::group_by(Season) %>% 
  mutate(count = n()) %>% 
  ggplot(aes(x = Season, y = count)) +
  geom_point() +
  geom_smooth(method = "loess")

# Month and count
month = c("January", "April", "May", "June", "July", "August", "September", "October", "November", "December")

storms_month_name = distinct(group_by(select(dt_long, Month, ID), Month))

storms_month_name %>% 
  dplyr::group_by(Month) %>% 
  mutate(count = n(),
         Month =  factor(Month, levels = month)) %>% 
  arrange(Month) %>% 
  ggplot(aes(x = Month, y = count)) +
  geom_point() +
  geom_smooth()

```



